<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Moofar Gallery</title>
<link rel="stylesheet" href="css/cleaned_css.css">
<link rel="icon" href="assets/favicon.ico">
<style>
body { font-family: Arial, sans-serif; margin:0; padding:0; }
header nav { padding:15px; text-align:center; background:#333; }
header nav a { color:#fff; margin:0 15px; text-decoration:none; font-weight:bold; }
header nav a:hover { text-decoration:underline; }
h1 { text-align:center; margin:30px 0 10px; }
.gallery { display:grid; grid-template-columns:repeat(auto-fill,minmax(250px,1fr)); gap:15px; padding:20px; max-width:1200px; margin:0 auto; }
.gallery img { width:100%; height:200px; object-fit:cover; border-radius:10px; cursor:pointer; transition:transform 0.3s ease; }
.gallery img:hover { transform:scale(1.05); }
#lightboxOverlay { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); align-items:center; justify-content:center; cursor:pointer; z-index:1000; }
#lightboxOverlay img { max-width:90%; max-height:90%; border-radius:10px; }
footer { text-align:center; padding:20px; background:#333; color:#fff; margin-top:40px; }
</style>
</head>
<body>

<header>
<nav>
<a href="index.html">Home</a>
<a href="services.html">Services</a>
<a href="gallery.html">Gallery</a>
<a href="contact.html">Contact</a>
</nav>
</header>

<main>
<h1>Our Gallery</h1>
<div class="gallery" id="gallery"></div>
<div id="lightboxOverlay"></div>
</main>

<footer>&copy; 2025 Moofar (PTY) LTD</footer>

<script>
const galleryDiv = document.getElementById('gallery');
const overlay = document.getElementById('lightboxOverlay');
let images = [], loadedCount = 0, batchSize = 20;

// Fetch images from serverless API
fetch('/api/gallery')
.then(res => res.json())
.then(data => { images = data; loadMoreImages(); })
.catch(err => console.error('Failed to load gallery images:', err));

function loadMoreImages() {
  const nextBatch = images.slice(loadedCount, loadedCount + batchSize);
  nextBatch.forEach(file => {
    const img = document.createElement('img');
    img.src = `assets/${file}`;
    img.alt = 'Gallery Image';
    img.loading = 'lazy';
    galleryDiv.appendChild(img);
  });
  loadedCount += nextBatch.length;
}

// Infinite scroll
window.addEventListener('scroll', () => {
  if ((window.innerHeight + window.scrollY) >= document.body.offsetHeight - 500) {
    if (loadedCount < images.length) loadMoreImages();
  }
});

// Lightbox
galleryDiv.addEventListener('click', e => {
  if(e.target.tagName==='IMG'){ overlay.innerHTML=`<img src="${e.target.src}" alt="Enlarged Image">`; overlay.style.display='flex'; }
});
overlay.addEventListener('click', () => { overlay.style.display='none'; });
</script>

</body>
</html>
